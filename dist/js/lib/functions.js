import*as vars from"./vars.js";const delay=e=>new Promise((t=>setTimeout(t,e)));function sendMessage(e){let t=document.querySelector(".chat-screen .messages"),o=document.createElement("p");o.textContent=`ServerName : ${e}`,t.appendChild(o),o.scrollIntoView({behavior:"smooth"})}function theme(e="dark"){"dark"===e?document.body.classList.add("dark-mode"):"light"===e?document.body.classList.remove("dark-mode"):console.error(`No Theme Called ${e}`)}function updateURL(e){const t=e.replace("-screen",""),o={screen:t};history.pushState(o,"",`${window.location.pathname}#${t}`)}async function navigateToScreen(e){const t=document.querySelector("."+e);t&&(t.style.display="block",await delay(10),t.style.left=0,document.body.classList.add("disable-scrolling"),updateURL(e))}function initializeFromURL(){if(""!==window.location.hash)try{let e=`${window.location.hash.match(/[^#]/gim).join("")}-screen`;history.pushState({screen:""},"",`${window.location.pathname}`),navigateToScreen(e)}catch(e){console.log("Error "+e)}}function loadSettings(){const e=JSON.parse(localStorage.getItem("config"))||{},t=vars.elesToSaveData;vars.radioElesToSaveData.forEach((t=>{document.querySelectorAll(`[data-group="${t.group}"]`).forEach((e=>e.checked=!1));const o=t.settingIds.reduce(((e,t)=>e?.[t]),e);document.querySelector(`[${t.elesSelector}=${o}]`).checked=!0})),t.forEach((t=>{const o=document.querySelector(t.id);if(!o)return;const s=t.settingIds.reduce(((e,t)=>e?.[t]),e);switch(t.type){case"input":case"color-selector":case"time-selector":o.value=s;break;case"switch":o.checked=Boolean(s);break;case"number-chooser":o.textContent=s}}))}function storeElesValues(){const e=vars.elesToSaveData,t=JSON.parse(localStorage.getItem("config"))||{};vars.radioElesToSaveData.forEach((e=>{let o=document.querySelectorAll(`[data-group="${e.group}"]`);o.forEach((s=>s.onclick=n=>{o.forEach((e=>e.checked=!1)),s.checked=!0;let a=t,c=s.dataset.bombname;console.log(c);for(let t=0;t<e.settingIds.length-1;t++){const o=e.settingIds[t];a[o]=a[o]||{},a=a[o]}a[e.settingIds[e.settingIds.length-1]]=c,localStorage.setItem("config",JSON.stringify(t))}))})),e.forEach((e=>{const o=document.querySelector(e.id);if(!o)return;const s="input"===e.type?"input":"click";"color-selector"===e.type||"time"===e.type?o.oninput=o=>{let s=o.target.value,n=t;for(let t=0;t<e.settingIds.length-1;t++){const o=e.settingIds[t];n[o]=n[o]||{},n=n[o]}n[e.settingIds[e.settingIds.length-1]]=s,localStorage.setItem("config",JSON.stringify(t))}:o.addEventListener(s,(o=>{let s;"input"===e.type&&(s=o.target.value),"switch"===e.type&&(s=o.target.checked),"number-chooser"===e.type&&(s=parseInt(o.target.textContent)),"color-selector"===e.type&&(s=o.target.value);let n=t;for(let t=0;t<e.settingIds.length-1;t++){const o=e.settingIds[t];n[o]=n[o]||{},n=n[o]}n[e.settingIds[e.settingIds.length-1]]=s,localStorage.setItem("config",JSON.stringify(t))}))}))}export{loadSettings,initializeFromURL,delay,navigateToScreen,updateURL,theme,sendMessage,storeElesValues};